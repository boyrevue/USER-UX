@prefix autoins: <https://autoins.example/ontology#> .
@prefix bipro: <https://bipro.net/ontology#> .
@prefix owl:    <http://www.w3.org/2002/07/owl#> .
@prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:    <http://www.w3.org/2001/XMLSchema#> .
@prefix foaf:   <http://xmlns.com/foaf/0.1/> .
@prefix schema: <https://schema.org/> .
@prefix skos:   <http://www.w3.org/2004/02/skos/core#> .
@prefix dct:    <http://purl.org/dc/terms/> .
@prefix sh:     <http://www.w3.org/ns/shacl#> .

############################################################
## AI CLAIMS HISTORY ONTOLOGY MODULE
############################################################

autoins:ClaimsHistoryModule a owl:Ontology ;
  rdfs:label "AI Claims History Module" ;
  owl:versionInfo "v3.0.0-2025-01-24" ;
  dct:creator "CLIENT-UX" ;
  dct:description "Comprehensive claims and incidents ontology covering claims history, accidents, convictions, and risk events for insurance underwriting" ;
  owl:imports autoins: ;
  # TOPIC-LEVEL GDPR COMPLIANCE - HIGHLY SENSITIVE
  autoins:dataClassification autoins:SensitivePersonalData ;
  autoins:personalDataCategory autoins:BehavioralData ;
  autoins:accessLevel autoins:StaffAccess ;
  autoins:consentRequired "true"^^xsd:boolean ;
  autoins:consentPurpose "Insurance risk assessment, underwriting, and fraud prevention" ;
  autoins:consentBasis autoins:LegitimateInterests ;
  autoins:retentionPeriod "P10Y" ;
  autoins:retentionReason "Insurance regulatory requirements and fraud detection" ;
  autoins:auditRequired "true"^^xsd:boolean ;
  autoins:gdprCompliant "true"^^xsd:boolean ;
  # TOPIC-LEVEL BIPRO COMPLIANCE
  bipro:normCompliance "430,419" ;
  bipro:germanMarketReady "true"^^xsd:boolean ;
  bipro:gdvMappingAvailable "true"^^xsd:boolean ;
  bipro:bafinCompliant "true"^^xsd:boolean ;
  bipro:vvgCompliant "true"^^xsd:boolean ;
  bipro:supportedGenerations "RClassic,RNext" ;
  bipro:certificationStatus "pending" ;
  bipro:lastValidated "2025-01-24"^^xsd:date ;
  bipro:fnolCompliant "true"^^xsd:boolean ;
  bipro:reserveCalculationReady "true"^^xsd:boolean .

############################################################
## ANNOTATION PROPERTIES & HELPERS
############################################################

# Internationalization Support
autoins:i18nKey a owl:AnnotationProperty ;
  rdfs:label "i18n key" ;
  rdfs:range xsd:string ;
  rdfs:comment "Internationalization key for multi-language support" .

autoins:helpTextKey a owl:AnnotationProperty ;
  rdfs:label "help text key" ;
  rdfs:range xsd:string ;
  rdfs:comment "Internationalization key for help text" .

autoins:errorMessageKey a owl:AnnotationProperty ;
  rdfs:label "error message key" ;
  rdfs:range xsd:string ;
  rdfs:comment "Internationalization key for error messages" .

############################################################
## CLAIMS DOCUMENT CLASSES
############################################################

# Claims Documents (from comprehensive ontology)
autoins:ClaimsDocument a owl:Class ;
    rdfs:label "Claims Document" ;
    rdfs:comment "Documents related to insurance claims and incidents" ;
    rdfs:subClassOf autoins:InsuranceEntity ;
    autoins:i18nKey "claims.document.label" .

autoins:ClaimForm a owl:Class ;
    rdfs:label "Claim Form" ;
    rdfs:comment "Insurance claim notification form" ;
    rdfs:subClassOf autoins:ClaimsDocument ;
    autoins:i18nKey "claims.form.label" .

autoins:AccidentReport a owl:Class ;
    rdfs:label "Accident Report" ;
    rdfs:comment "Detailed accident incident report" ;
    rdfs:subClassOf autoins:ClaimsDocument ;
    autoins:i18nKey "claims.accident_report.label" .

autoins:PoliceReport a owl:Class ;
    rdfs:label "Police Report" ;
    rdfs:comment "Official police incident report" ;
    rdfs:subClassOf autoins:ClaimsDocument ;
    autoins:i18nKey "claims.police_report.label" .

autoins:RepairEstimate a owl:Class ;
    rdfs:label "Repair Estimate" ;
    rdfs:comment "Vehicle repair cost estimate" ;
    rdfs:subClassOf autoins:ClaimsDocument ;
    autoins:i18nKey "claims.repair_estimate.label" .

autoins:SettlementLetter a owl:Class ;
    rdfs:label "Settlement Letter" ;
    rdfs:comment "Claim settlement agreement" ;
    rdfs:subClassOf autoins:ClaimsDocument ;
    autoins:i18nKey "claims.settlement_letter.label" .

############################################################
## CORE RISK EVENT CLASSES
############################################################

# Root Risk Event Class
autoins:RiskEvent a owl:Class ;
  rdfs:label "Risk Event" ;
  rdfs:comment "Any incident that impacts insurance risk assessment, whether claimed or not" ;
  autoins:i18nKey "claims.risk_event.label" .

# Primary Risk Event Sub-Classes
autoins:Claim a owl:Class ;
  rdfs:subClassOf autoins:RiskEvent ;
  rdfs:label "Insurance Claim" ;
  rdfs:comment "A formal request made to an insurance company for coverage or compensation" ;
  autoins:i18nKey "claims.claim.label" .

autoins:Accident a owl:Class ;
  rdfs:subClassOf autoins:RiskEvent ;
  rdfs:label "Accident/Incident" ;
  rdfs:comment "An incident that may or may not have resulted in a formal insurance claim - critical for risk assessment" ;
  autoins:i18nKey "claims.accident.label" .

autoins:Conviction a owl:Class ;
  rdfs:label "Driving Conviction" ;
  rdfs:comment "Driving conviction with penalty points - moved from driver module for claims integration" ;
  autoins:i18nKey "claims.conviction.label" .

############################################################
## CLAIMS HISTORY MANAGEMENT CLASSES
############################################################

autoins:ClaimsHistory a owl:Class ;
  rdfs:label "Claims History" ;
  rdfs:comment "Complete claims history for the last 5 years" ;
  autoins:i18nKey "claims.history.label" .

############################################################
## CONTROLLED VOCABULARIES (SKOS CONCEPT SCHEMES)
############################################################

# Claim Type Vocabulary
autoins:ClaimTypeScheme a skos:ConceptScheme ;
  rdfs:label "Insurance Claim Types" ;
  skos:prefLabel "Standardized claim type classifications for underwriting" ;
  autoins:i18nKey "claims.claim_type_scheme.label" .

autoins:CollisionClaim a skos:Concept ;
  skos:inScheme autoins:ClaimTypeScheme ;
  skos:prefLabel "Collision" ;
  skos:definition "Vehicle collision with another vehicle or object" ;
  autoins:i18nKey "claims.collision_claim.label" .

autoins:TheftClaim a skos:Concept ;
  skos:inScheme autoins:ClaimTypeScheme ;
  skos:prefLabel "Theft" ;
  skos:definition "Vehicle theft or attempted theft" ;
  autoins:i18nKey "claims.theft_claim.label" .

autoins:VandalismClaim a skos:Concept ;
  skos:inScheme autoins:ClaimTypeScheme ;
  skos:prefLabel "Vandalism" ;
  skos:definition "Intentional damage to vehicle" ;
  autoins:i18nKey "claims.vandalism_claim.label" .

autoins:WindshieldClaim a skos:Concept ;
  skos:inScheme autoins:ClaimTypeScheme ;
  skos:prefLabel "Windshield/Glass" ;
  skos:definition "Windshield or glass damage" ;
  autoins:i18nKey "claims.windshield_claim.label" .

autoins:LiabilityClaim a skos:Concept ;
  skos:inScheme autoins:ClaimTypeScheme ;
  skos:prefLabel "Liability" ;
  skos:definition "Third party liability claim" ;
  autoins:i18nKey "claims.liability_claim.label" .

autoins:ComprehensiveClaim a skos:Concept ;
  skos:inScheme autoins:ClaimTypeScheme ;
  skos:prefLabel "Comprehensive" ;
  skos:definition "Weather, fire, flood, or other comprehensive coverage" ;
  autoins:i18nKey "claims.comprehensive_claim.label" .

# Fault Status Vocabulary
autoins:FaultStatusScheme a skos:ConceptScheme ;
  rdfs:label "Fault Status Classifications" ;
  skos:prefLabel "Standardized fault determinations for risk assessment" ;
  autoins:i18nKey "claims.fault_status_scheme.label" .

autoins:AtFault a skos:Concept ;
  skos:inScheme autoins:FaultStatusScheme ;
  skos:prefLabel "At-fault" ;
  skos:definition "Policyholder determined to be at fault" ;
  autoins:i18nKey "claims.at_fault.label" .

autoins:NotAtFault a skos:Concept ;
  skos:inScheme autoins:FaultStatusScheme ;
  skos:prefLabel "Not-at-fault" ;
  skos:definition "Policyholder not at fault for incident" ;
  autoins:i18nKey "claims.not_at_fault.label" .

autoins:PartialFault a skos:Concept ;
  skos:inScheme autoins:FaultStatusScheme ;
  skos:prefLabel "Partial fault" ;
  skos:definition "Shared fault determination" ;
  autoins:i18nKey "claims.partial_fault.label" .

############################################################
## CLAIMS OBJECT PROPERTIES
############################################################

autoins:hasClaimsHistory a owl:ObjectProperty ;
  rdfs:domain autoins:QuoteRequest ;
  rdfs:range autoins:ClaimsHistory ;
  rdfs:label "has claims history" ;
  autoins:isRequired "true"^^xsd:boolean ;
  rdfs:comment "Links to claims history" ;
  autoins:i18nKey "claims.has_claims_history.label" .

############################################################
## CLAIMS HISTORY PROPERTIES
############################################################

autoins:hasClaims a owl:DatatypeProperty ;
  rdfs:domain autoins:ClaimsHistory ;
  rdfs:range xsd:boolean ;
  rdfs:label "has claims" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:formHelpText "Have you made any insurance claims in the last 5 years?" ;
  autoins:i18nKey "claims.has_claims.label" ;
  autoins:helpTextKey "claims.has_claims.help" .

autoins:hasAccidents a owl:DatatypeProperty ;
  rdfs:domain autoins:ClaimsHistory ;
  rdfs:range xsd:boolean ;
  rdfs:label "has accidents" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:formHelpText "Have you been involved in any accidents in the last 5 years?" ;
  autoins:i18nKey "claims.has_accidents.label" ;
  autoins:helpTextKey "claims.has_accidents.help" .

autoins:claimsCount a owl:DatatypeProperty ;
  rdfs:domain autoins:ClaimsHistory ;
  rdfs:range xsd:integer ;
  rdfs:label "claims count" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Total number of claims in the last 5 years" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 5 ;
  autoins:i18nKey "claims.claims_count.label" ;
  autoins:helpTextKey "claims.claims_count.help" .

autoins:accidentsCount a owl:DatatypeProperty ;
  rdfs:domain autoins:ClaimsHistory ;
  rdfs:range xsd:integer ;
  rdfs:label "accidents count" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Total number of accidents in the last 5 years" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 10 ;
  autoins:i18nKey "claims.accidents_count.label" ;
  autoins:helpTextKey "claims.accidents_count.help" .

############################################################
## INDIVIDUAL CLAIM PROPERTIES
############################################################

autoins:claimDate a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:date ;
  rdfs:label "claim date" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:formHelpText "Date when the claim was made" ;
  autoins:i18nKey "claims.claim_date.label" ;
  autoins:helpTextKey "claims.claim_date.help" .

autoins:incidentDate a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:date ;
  rdfs:label "incident date" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:formHelpText "Date when the actual incident occurred" ;
  autoins:i18nKey "claims.incident_date.label" ;
  autoins:helpTextKey "claims.incident_date.help" .

autoins:claimType a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "claim type" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:enumerationValues ("Accident Damage" "Theft" "Fire" "Flood" "Vandalism" "Glass Damage" "Storm Damage" "Third Party" "Collision" "Comprehensive" "Liability" "Other") ;
  autoins:formHelpText "Type of claim made" ;
  autoins:i18nKey "claims.claim_type.label" ;
  autoins:helpTextKey "claims.claim_type.help" .

autoins:claimAmount a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "claim amount" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:formHelpText "Total amount claimed (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 100000 ;
  autoins:i18nKey "claims.claim_amount.label" ;
  autoins:helpTextKey "claims.claim_amount.help" ;
  # GDPR Compliance - SENSITIVE FINANCIAL DATA
  autoins:dataClassification autoins:SensitivePersonalData ;
  autoins:personalDataCategory autoins:FinancialData ;
  autoins:accessLevel autoins:StaffAccess ;
  autoins:viewPermission "STAFF,MANAGER,ADMIN,AUDITOR" ;
  autoins:editPermission "STAFF,MANAGER,ADMIN" ;
  autoins:deletePermission "ADMIN" ;
  autoins:obfuscationMethod autoins:PartialMasking ;
  autoins:maskingPattern "Â£**,***" ;
  autoins:consentRequired "true"^^xsd:boolean ;
  autoins:consentPurpose "Claims processing and fraud detection" ;
  autoins:consentBasis autoins:LegitimateInterests ;
  autoins:retentionPeriod "P10Y" ;
  autoins:retentionReason "Insurance regulatory and legal requirements" ;
  autoins:auditRequired "true"^^xsd:boolean ;
  autoins:logLevel autoins:CriticalLogging .

autoins:paidAmount a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "paid amount" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Actual amount paid by insurer (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 100000 ;
  autoins:i18nKey "claims.paid_amount.label" ;
  autoins:helpTextKey "claims.paid_amount.help" .

autoins:claimStatus a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "claim status" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:enumerationValues ("Open" "Closed" "Settled" "Declined" "Withdrawn" "Under Investigation" "Closed-Paid" "Closed-Denied") ;
  autoins:formHelpText "Current status of the claim" ;
  autoins:i18nKey "claims.claim_status.label" ;
  autoins:helpTextKey "claims.claim_status.help" .

autoins:faultStatus a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "fault status" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:enumerationValues ("At Fault" "Not At Fault" "Split Liability" "Disputed" "Unknown" "Partial Fault") ;
  autoins:formHelpText "Who was at fault for the incident?" ;
  autoins:i18nKey "claims.fault_status.label" ;
  autoins:helpTextKey "claims.fault_status.help" .

autoins:faultPercentage a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:integer ;
  rdfs:label "fault percentage" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Percentage of fault attributed to you (0-100%)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 100 ;
  autoins:i18nKey "claims.fault_percentage.label" ;
  autoins:helpTextKey "claims.fault_percentage.help" .

autoins:policeReported a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "police reported" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was the incident reported to police?" ;
  autoins:i18nKey "claims.police_reported.label" ;
  autoins:helpTextKey "claims.police_reported.help" .

autoins:crimeReference a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "crime reference" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Police crime reference number (if applicable)" ;
  autoins:i18nKey "claims.crime_reference.label" ;
  autoins:helpTextKey "claims.crime_reference.help" .

autoins:claimDescription a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "claim description" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Brief description of the incident" ;
  autoins:i18nKey "claims.claim_description.label" ;
  autoins:helpTextKey "claims.claim_description.help" .

autoins:claimNumber a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "claim number" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Unique claim identifier from insurer" ;
  autoins:i18nKey "claims.claim_number.label" ;
  autoins:helpTextKey "claims.claim_number.help" .

############################################################
## CLAIM SETTLEMENT PROPERTIES
############################################################

autoins:settledAmount a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "settled amount" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Amount actually paid by insurer (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 100000 ;
  autoins:i18nKey "claims.settled_amount.label" ;
  autoins:helpTextKey "claims.settled_amount.help" .

autoins:excessPaid a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "excess paid" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Excess amount paid by you (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 5000 ;
  autoins:i18nKey "claims.excess_paid.label" ;
  autoins:helpTextKey "claims.excess_paid.help" .

autoins:recoveryAmount a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "recovery amount" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Amount recovered from third party (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 100000 ;
  autoins:i18nKey "claims.recovery_amount.label" ;
  autoins:helpTextKey "claims.recovery_amount.help" .

autoins:settlementDate a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:date ;
  rdfs:label "settlement date" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Date when claim was settled" ;
  autoins:i18nKey "claims.settlement_date.label" ;
  autoins:helpTextKey "claims.settlement_date.help" .

autoins:deductibleAmount a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "deductible amount" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Deductible paid by policyholder (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 5000 ;
  autoins:i18nKey "claims.deductible_amount.label" ;
  autoins:helpTextKey "claims.deductible_amount.help" .

############################################################
## ACCIDENT PROPERTIES
############################################################

# accidentDate moved to AI_Driver_Details.ttl to avoid duplication

autoins:accidentType a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "accident type" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:enumerationValues ("Collision" "Single Vehicle" "Multi-Vehicle" "Pedestrian" "Cyclist" "Animal" "Object" "Weather Related") ;
  autoins:formHelpText "Type of accident" ;
  autoins:i18nKey "claims.accident_type.label" ;
  autoins:helpTextKey "claims.accident_type.help" .

autoins:accidentSeverity a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "accident severity" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:enumerationValues ("Minor" "Moderate" "Serious" "Fatal") ;
  autoins:formHelpText "Severity of the accident" ;
  autoins:i18nKey "claims.accident_severity.label" ;
  autoins:helpTextKey "claims.accident_severity.help" .

autoins:accidentLocation a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "accident location" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Location where accident occurred" ;
  autoins:i18nKey "claims.accident_location.label" ;
  autoins:helpTextKey "claims.accident_location.help" .

autoins:accidentCause a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "accident cause" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:enumerationValues ("Speeding" "Careless Driving" "Weather" "Mechanical Failure" "Road Conditions" "Other Driver" "Distraction" "Fatigue" "Other") ;
  autoins:formHelpText "Primary cause of the accident" ;
  autoins:i18nKey "claims.accident_cause.label" ;
  autoins:helpTextKey "claims.accident_cause.help" .

autoins:claimMade a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:boolean ;
  rdfs:label "claim made" ;
  autoins:isRequired "true"^^xsd:boolean ;
  autoins:formHelpText "Was an insurance claim made for this accident?" ;
  autoins:i18nKey "claims.claim_made.label" ;
  autoins:helpTextKey "claims.claim_made.help" .

autoins:accidentDescription a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "accident description" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Brief description of what happened" ;
  autoins:i18nKey "claims.accident_description.label" ;
  autoins:helpTextKey "claims.accident_description.help" .

autoins:damageDescription a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "damage description" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Detailed description of vehicle/property damage" ;
  autoins:i18nKey "claims.damage_description.label" ;
  autoins:helpTextKey "claims.damage_description.help" .

autoins:estimatedDamageAmount a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:decimal ;
  rdfs:label "estimated damage amount" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Estimated cost of damage - key risk indicator (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 100000 ;
  autoins:i18nKey "claims.estimated_damage_amount.label" ;
  autoins:helpTextKey "claims.estimated_damage_amount.help" .

############################################################
## INJURY & DAMAGE PROPERTIES
############################################################

autoins:injuriesReported a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:boolean ;
  rdfs:label "injuries reported" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Were any injuries reported?" ;
  autoins:i18nKey "claims.injuries_reported.label" ;
  autoins:helpTextKey "claims.injuries_reported.help" .

autoins:injuryCount a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:integer ;
  rdfs:label "injury count" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Number of people injured" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 20 ;
  autoins:i18nKey "claims.injury_count.label" ;
  autoins:helpTextKey "claims.injury_count.help" .

autoins:vehicleDamage a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "vehicle damage" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:enumerationValues ("None" "Minor" "Moderate" "Severe" "Total Loss") ;
  autoins:formHelpText "Extent of vehicle damage" ;
  autoins:i18nKey "claims.vehicle_damage.label" ;
  autoins:helpTextKey "claims.vehicle_damage.help" .

autoins:propertyDamage a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:boolean ;
  rdfs:label "property damage" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was any other property damaged?" ;
  autoins:i18nKey "claims.property_damage.label" ;
  autoins:helpTextKey "claims.property_damage.help" .

autoins:emergencyServices a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:boolean ;
  rdfs:label "emergency services" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Were emergency services called?" ;
  autoins:i18nKey "claims.emergency_services.label" ;
  autoins:helpTextKey "claims.emergency_services.help" .

autoins:numberOfVehiclesInvolved a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:integer ;
  rdfs:label "number of vehicles involved" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Total vehicles involved in accident" ;
  autoins:minInclusive 1 ;
  autoins:maxInclusive 10 ;
  autoins:i18nKey "claims.number_of_vehicles_involved.label" ;
  autoins:helpTextKey "claims.number_of_vehicles_involved.help" .

autoins:numberOfInjuries a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:integer ;
  rdfs:label "number of injuries" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Total number of people injured" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 20 ;
  autoins:i18nKey "claims.number_of_injuries.label" ;
  autoins:helpTextKey "claims.number_of_injuries.help" .

############################################################
## POLICE & LEGAL PROPERTIES
############################################################

autoins:policeReportFiled a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:boolean ;
  rdfs:label "police report filed" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Whether official police report was filed" ;
  autoins:i18nKey "claims.police_report_filed.label" ;
  autoins:helpTextKey "claims.police_report_filed.help" .

autoins:policeReportNumber a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:string ;
  rdfs:label "police report number" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Official police report reference number" ;
  autoins:i18nKey "claims.police_report_number.label" ;
  autoins:helpTextKey "claims.police_report_number.help" .

autoins:citationIssued a owl:DatatypeProperty ;
  rdfs:domain autoins:Accident ;
  rdfs:range xsd:boolean ;
  rdfs:label "citation issued" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Whether traffic citation was issued" ;
  autoins:i18nKey "claims.citation_issued.label" ;
  autoins:helpTextKey "claims.citation_issued.help" .

############################################################
## CONVICTION PROPERTIES - MOVED TO AI_Driver_Details.ttl
############################################################
# Conviction fields have been moved to the Driver Details ontology to eliminate duplication
# and ensure proper field types (single/multi-select) based on UK insurance requirements.

############################################################
## THIRD PARTY & REPAIR INFORMATION
############################################################

autoins:thirdPartyInvolved a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "third party involved" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was a third party involved in the incident?" ;
  autoins:i18nKey "claims.third_party_involved.label" ;
  autoins:helpTextKey "claims.third_party_involved.help" .

autoins:thirdPartyInsurer a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:string ;
  rdfs:label "third party insurer" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Third party's insurance company" ;
  autoins:i18nKey "claims.third_party_insurer.label" ;
  autoins:helpTextKey "claims.third_party_insurer.help" .

autoins:repairRequired a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "repair required" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was vehicle repair required?" ;
  autoins:i18nKey "claims.repair_required.label" ;
  autoins:helpTextKey "claims.repair_required.help" .

autoins:repairCost a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:decimal ;
  rdfs:label "repair cost" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Total cost of repairs (Â£)" ;
  autoins:minInclusive 0 ;
  autoins:maxInclusive 50000 ;
  autoins:i18nKey "claims.repair_cost.label" ;
  autoins:helpTextKey "claims.repair_cost.help" .

autoins:totalLoss a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "total loss" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was the vehicle declared a total loss?" ;
  autoins:i18nKey "claims.total_loss.label" ;
  autoins:helpTextKey "claims.total_loss.help" .

############################################################
## CLAIMS VALIDATION PROPERTIES
############################################################

autoins:withinTimeLimit a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "within time limit" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was claim made within policy time limits?" ;
  autoins:i18nKey "claims.within_time_limit.label" ;
  autoins:helpTextKey "claims.within_time_limit.help" .

autoins:previouslyDeclared a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "previously declared" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Was this claim previously declared to other insurers?" ;
  autoins:i18nKey "claims.previously_declared.label" ;
  autoins:helpTextKey "claims.previously_declared.help" .

autoins:affectsNCD a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "affects NCD" ;
  autoins:isRequired "false"^^xsd:boolean ;
  autoins:formHelpText "Does this claim affect your no claims discount?" ;
  autoins:i18nKey "claims.affects_ncd.label" ;
  autoins:helpTextKey "claims.affects_ncd.help" .

############################################################
## SHACL VALIDATION SHAPES FOR CLAIMS
############################################################

autoins:ClaimShape a sh:NodeShape ;
  sh:targetClass autoins:Claim ;
  rdfs:label "Claim Validation Shape" ;
  sh:property [
    sh:path autoins:claimDate ;
    sh:datatype xsd:date ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "Claim date is required"
  ] ;
  sh:property [
    sh:path autoins:claimType ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:in ("Accident Damage" "Theft" "Fire" "Flood" "Vandalism" "Glass Damage" "Storm Damage" "Third Party" "Collision" "Comprehensive" "Liability" "Other") ;
    sh:message "Valid claim type must be selected"
  ] ;
  sh:property [
    sh:path autoins:claimAmount ;
    sh:datatype xsd:decimal ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:minInclusive 0 ;
    sh:maxInclusive 100000 ;
    sh:message "Claim amount must be between Â£0 and Â£100,000"
  ] ;
  sh:property [
    sh:path autoins:faultStatus ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:in ("At Fault" "Not At Fault" "Split Liability" "Disputed" "Unknown" "Partial Fault") ;
    sh:message "Fault status must be specified"
  ] .

autoins:AccidentShape a sh:NodeShape ;
  sh:targetClass autoins:Accident ;
  rdfs:label "Accident Validation Shape" ;
  sh:property [
    sh:path autoins:accidentDate ;
    sh:datatype xsd:dateTime ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "Accident date is required"
  ] ;
  sh:property [
    sh:path autoins:accidentType ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:in ("Collision" "Single Vehicle" "Multi-Vehicle" "Pedestrian" "Cyclist" "Animal" "Object" "Weather Related") ;
    sh:message "Valid accident type must be selected"
  ] ;
  sh:property [
    sh:path autoins:claimMade ;
    sh:datatype xsd:boolean ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "Must specify if claim was made"
  ] .

autoins:ConvictionShape a sh:NodeShape ;
  sh:targetClass autoins:Conviction ;
  rdfs:label "Conviction Validation Shape" ;
  sh:property [
    sh:path autoins:convictionDate ;
    sh:datatype xsd:date ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "Conviction date is required"
  ] ;
  sh:property [
    sh:path autoins:convictionType ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:in ("Speeding" "Careless Driving" "Dangerous Driving" "Drink Driving" "Drug Driving" "No Insurance" "No Licence" "Other") ;
    sh:message "Valid conviction type must be selected"
  ] ;
  sh:property [
    sh:path autoins:convictionPoints ;
    sh:datatype xsd:integer ;
    sh:minInclusive 0 ;
    sh:maxInclusive 12 ;
    sh:message "Conviction points must be between 0 and 12"
  ] .

############################################################
## 5-YEAR HISTORICAL DATA VALIDATION CONSTRAINTS
############################################################

# 5-Year Claims History Validation Shape
autoins:ClaimsHistoryValidationShape a sh:NodeShape ;
  sh:targetClass autoins:Claim ;
  rdfs:label "Claims History 5-Year Validation" ;
  rdfs:comment "Ensures claims are within the last 5 years for insurance underwriting purposes" ;
  sh:property [
    sh:path autoins:claimDate ;
    sh:name "Claim Date 5-Year Limit" ;
    sh:description "Claims must be within the last 5 years" ;
    sh:datatype xsd:date ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    # Date validation will be dynamically calculated in backend
    sh:message "âš ï¸ CLAIM DATE ERROR: Claim date must be within the last 5 years (since {FIVE_YEARS_AGO}). Claims older than 5 years are not considered for current insurance underwriting and may affect your quote accuracy." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "CLAIM_DATE_TOO_OLD" ;
    autoins:validationRule "claimDate >= (TODAY - P5Y) AND claimDate <= TODAY" ;
    autoins:gdprNote "Historical claims data older than 5 years may be subject to different retention policies under GDPR Article 17" ;
    autoins:i18nKey "validation.claim_date.five_year_limit" ;
    autoins:helpTextKey "validation.claim_date.five_year_help"
  ] ;
  sh:property [
    sh:path autoins:claimAmount ;
    sh:name "Claim Amount Validation" ;
    sh:description "Claim amount must be positive and within reasonable limits" ;
    sh:datatype xsd:decimal ;
    sh:minInclusive 0.01 ;
    sh:maxInclusive 1000000.00 ;
    sh:message "ðŸ’° CLAIM AMOUNT ERROR: Claim amount must be between Â£0.01 and Â£1,000,000. Please enter a valid claim amount." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "INVALID_CLAIM_AMOUNT" ;
    autoins:i18nKey "validation.claim_amount.range" ;
    autoins:helpTextKey "validation.claim_amount.help"
  ] .

# 5-Year Accident History Validation Shape  
autoins:AccidentHistoryValidationShape a sh:NodeShape ;
  sh:targetClass autoins:Accident ;
  rdfs:label "Accident History 5-Year Validation" ;
  rdfs:comment "Ensures accidents are within the last 5 years for insurance risk assessment" ;
  sh:property [
    sh:path autoins:accidentDate ;
    sh:name "Accident Date 5-Year Limit" ;
    sh:description "Accidents must be within the last 5 years" ;
    sh:datatype xsd:date ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "ðŸš— ACCIDENT DATE ERROR: Accident date must be within the last 5 years (since {FIVE_YEARS_AGO}). Accidents older than 5 years are not considered for current insurance risk assessment." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "ACCIDENT_DATE_TOO_OLD" ;
    autoins:validationRule "accidentDate >= (TODAY - P5Y) AND accidentDate <= TODAY" ;
    autoins:gdprNote "Historical accident data older than 5 years may be subject to different retention policies" ;
    autoins:i18nKey "validation.accident_date.five_year_limit" ;
    autoins:helpTextKey "validation.accident_date.five_year_help"
  ] ;
  sh:property [
    sh:path autoins:estimatedCost ;
    sh:name "Accident Cost Validation" ;
    sh:description "Accident cost must be positive if provided" ;
    sh:datatype xsd:decimal ;
    sh:minInclusive 0.00 ;
    sh:maxInclusive 1000000.00 ;
    sh:message "ðŸ’· ACCIDENT COST WARNING: Accident cost must be between Â£0 and Â£1,000,000 if provided." ;
    autoins:validationSeverity "WARNING" ;
    autoins:validationCode "INVALID_ACCIDENT_COST" ;
    autoins:i18nKey "validation.accident_cost.range" ;
    autoins:helpTextKey "validation.accident_cost.help"
  ] .

# Conviction History Validation Shape (also 5-year limit)
autoins:ConvictionHistoryValidationShape a sh:NodeShape ;
  sh:targetClass autoins:DrivingConviction ;
  rdfs:label "Conviction History 5-Year Validation" ;
  rdfs:comment "Ensures driving convictions are within the last 5 years for insurance underwriting" ;
  sh:property [
    sh:path autoins:convictionDate ;
    sh:name "Conviction Date 5-Year Limit" ;
    sh:description "Driving convictions must be within the last 5 years" ;
    sh:datatype xsd:date ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "âš–ï¸ CONVICTION DATE ERROR: Conviction date must be within the last 5 years (since {FIVE_YEARS_AGO}). Convictions older than 5 years are typically spent under the Rehabilitation of Offenders Act and not considered for current insurance underwriting." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "CONVICTION_DATE_TOO_OLD" ;
    autoins:validationRule "convictionDate >= (TODAY - P5Y) AND convictionDate <= TODAY" ;
    autoins:gdprNote "Spent convictions older than 5 years may be subject to rehabilitation of offenders legislation and GDPR right to erasure" ;
    autoins:legalNote "Under the Rehabilitation of Offenders Act 1974, most convictions become spent after 5 years" ;
    autoins:i18nKey "validation.conviction_date.five_year_limit" ;
    autoins:helpTextKey "validation.conviction_date.five_year_help"
  ] ;
  sh:property [
    sh:path autoins:penaltyPoints ;
    sh:name "Penalty Points Validation" ;
    sh:description "Penalty points must be within valid DVLA range" ;
    sh:datatype xsd:integer ;
    sh:minInclusive 0 ;
    sh:maxInclusive 12 ;
    sh:message "ðŸŽ¯ PENALTY POINTS ERROR: Penalty points must be between 0 and 12 points as per DVLA regulations." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "INVALID_PENALTY_POINTS" ;
    autoins:i18nKey "validation.penalty_points.range" ;
    autoins:helpTextKey "validation.penalty_points.help"
  ] .

# Future Date Validation (prevent future dates)
autoins:FutureDateValidationShape a sh:NodeShape ;
  sh:targetClass autoins:Claim, autoins:Accident, autoins:DrivingConviction ;
  rdfs:label "Future Date Prevention" ;
  rdfs:comment "Prevents entry of future dates for historical events" ;
  sh:property [
    sh:path autoins:claimDate, autoins:accidentDate, autoins:convictionDate ;
    sh:name "No Future Dates" ;
    sh:description "Historical events cannot have future dates" ;
    sh:datatype xsd:date ;
    sh:message "ðŸ“… FUTURE DATE ERROR: You cannot enter a future date for a historical event. Please check the date and try again." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FUTURE_DATE_NOT_ALLOWED" ;
    autoins:validationRule "eventDate <= TODAY" ;
    autoins:i18nKey "validation.future_date.not_allowed" ;
    autoins:helpTextKey "validation.future_date.help"
  ] .

############################################################
## VALIDATION ERROR MESSAGES & HELP TEXT
############################################################

# Validation Message Templates
autoins:ValidationMessages a owl:Class ;
  rdfs:label "Validation Messages" ;
  rdfs:comment "Standardized validation error messages for user feedback" .

autoins:ClaimDateTooOldMessage a autoins:ValidationMessage ;
  rdfs:label "Claim Date Too Old" ;
  autoins:messageTemplate "âš ï¸ The claim date you entered ({ENTERED_DATE}) is more than 5 years old. For accurate insurance quotes, we only consider claims from the last 5 years (since {FIVE_YEARS_AGO}). If this claim is still relevant to your insurance history, please contact our support team." ;
  autoins:severity "ERROR" ;
  autoins:code "CLAIM_DATE_TOO_OLD" ;
  autoins:suggestedAction "Please enter a claim date within the last 5 years, or remove this claim if it's no longer relevant." .

autoins:AccidentDateTooOldMessage a autoins:ValidationMessage ;
  rdfs:label "Accident Date Too Old" ;
  autoins:messageTemplate "ðŸš— The accident date you entered ({ENTERED_DATE}) is more than 5 years old. For current risk assessment, we only consider accidents from the last 5 years (since {FIVE_YEARS_AGO}). Older accidents typically don't affect your current insurance premium." ;
  autoins:severity "ERROR" ;
  autoins:code "ACCIDENT_DATE_TOO_OLD" ;
  autoins:suggestedAction "Please enter an accident date within the last 5 years, or remove this accident if it's older than 5 years." .

autoins:ConvictionDateTooOldMessage a autoins:ValidationMessage ;
  rdfs:label "Conviction Date Too Old" ;
  autoins:messageTemplate "âš–ï¸ The conviction date you entered ({ENTERED_DATE}) is more than 5 years old. Under UK law, most driving convictions become 'spent' after 5 years and don't need to be declared for insurance purposes. We only consider convictions from the last 5 years (since {FIVE_YEARS_AGO})." ;
  autoins:severity "ERROR" ;
  autoins:code "CONVICTION_DATE_TOO_OLD" ;
  autoins:suggestedAction "Please enter a conviction date within the last 5 years, or remove this conviction if it's spent (older than 5 years)." ;
  autoins:legalReference "Rehabilitation of Offenders Act 1974" .

############################################################
## UK DRIVING AGE & HUMAN AGE VALIDATION CONSTRAINTS
############################################################

# UK Driving Age Validation Shape
autoins:UKDrivingAgeValidationShape a sh:NodeShape ;
  sh:targetClass autoins:Driver ;
  rdfs:label "UK Driving Age Validation" ;
  rdfs:comment "Ensures drivers meet UK minimum driving age requirements and realistic human age limits" ;
  sh:property [
    sh:path autoins:dateOfBirth ;
    sh:name "UK Driving Age & Human Age Limits" ;
    sh:description "Driver must be 17-130 years old" ;
    sh:datatype xsd:date ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "ðŸš— DRIVING AGE ERROR: Driver must be between 17 and 130 years old to drive in the UK. Current age: {CALCULATED_AGE} years." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "INVALID_DRIVING_AGE" ;
    autoins:validationRule "age >= 17 AND age <= 130" ;
    autoins:ukLegalNote "Road Traffic Act 1988 - Minimum driving age in UK is 17 years" ;
    autoins:humanLimitNote "Maximum realistic human age set to 130 years for data integrity" ;
    autoins:i18nKey "validation.driving_age.uk_limits" ;
    autoins:helpTextKey "validation.driving_age.help"
  ] .

# Licence Issue Age Validation Shape
autoins:LicenceIssueAgeValidationShape a sh:NodeShape ;
  sh:targetClass autoins:Driver ;
  rdfs:label "Licence Issue Age Validation" ;
  rdfs:comment "Ensures driving licence was issued when driver was old enough" ;
  sh:property [
    sh:path autoins:licenceIssueDate ;
    sh:name "Licence Issue Age Check" ;
    sh:description "Licence cannot be issued before age 17" ;
    sh:datatype xsd:date ;
    sh:message "ðŸ“‹ LICENCE AGE ERROR: UK driving licence cannot be issued before age 17. This licence was issued when the driver was {AGE_AT_ISSUE} years old." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "LICENCE_ISSUED_TOO_YOUNG" ;
    autoins:validationRule "ageAtLicenceIssue >= 17" ;
    autoins:ukLegalNote "DVLA regulations - Cannot issue licence before 17th birthday" ;
    autoins:i18nKey "validation.licence_age.minimum" ;
    autoins:helpTextKey "validation.licence_age.help"
  ] .

# Historical DVLA Records Validation
autoins:DVLARecordsValidationShape a sh:NodeShape ;
  sh:targetClass autoins:Driver ;
  rdfs:label "DVLA Records Historical Validation" ;
  rdfs:comment "Ensures licence dates are within DVLA record-keeping period" ;
  sh:property [
    sh:path autoins:licenceIssueDate ;
    sh:name "DVLA Records Period" ;
    sh:description "DVLA computerized records start from 1970" ;
    sh:datatype xsd:date ;
    sh:minInclusive "1970-01-01"^^xsd:date ;
    sh:message "ðŸ“‹ DVLA RECORDS ERROR: UK DVLA computerized records start from 1970. Please enter a licence date after 1970-01-01." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "LICENCE_DATE_BEFORE_DVLA_RECORDS" ;
    autoins:validationRule "licenceIssueDate >= 1970-01-01" ;
    autoins:historicalNote "DVLA computerized record-keeping began in the early 1970s" ;
    autoins:i18nKey "validation.dvla_records.historical_limit" ;
    autoins:helpTextKey "validation.dvla_records.help"
  ] .

############################################################
## AGE CALCULATION & VALIDATION MESSAGES
############################################################

# Age Validation Message Templates
autoins:AgeValidationMessages a owl:Class ;
  rdfs:label "Age Validation Messages" ;
  rdfs:comment "Standardized age validation error messages for UK driving requirements" .

autoins:TooYoungToDriveMessage a autoins:ValidationMessage ;
  rdfs:label "Too Young To Drive" ;
  autoins:messageTemplate "ðŸš— The driver is only {CALCULATED_AGE} years old. In the UK, you must be at least 17 years old to drive. Please check the birth date or wait until the driver reaches the minimum age." ;
  autoins:severity "ERROR" ;
  autoins:code "TOO_YOUNG_TO_DRIVE" ;
  autoins:suggestedAction "Verify the birth date is correct, or wait until the driver turns 17." ;
  autoins:legalReference "Road Traffic Act 1988, Section 101" .

autoins:TooOldToBeRealisticMessage a autoins:ValidationMessage ;
  rdfs:label "Age Exceeds Realistic Limits" ;
  autoins:messageTemplate "ðŸ‘´ The calculated age is {CALCULATED_AGE} years old, which exceeds our maximum age limit of 130 years. Please check the birth date for accuracy." ;
  autoins:severity "ERROR" ;
  autoins:code "AGE_EXCEEDS_REALISTIC_LIMITS" ;
  autoins:suggestedAction "Please verify the birth date is entered correctly (DD/MM/YYYY format)." .

autoins:LicenceIssuedTooYoungMessage a autoins:ValidationMessage ;
  rdfs:label "Licence Issued Too Young" ;
  autoins:messageTemplate "ðŸ“‹ This driving licence was issued when the driver was {AGE_AT_ISSUE} years old. UK law requires drivers to be at least 17 years old when their licence is issued." ;
  autoins:severity "ERROR" ;
  autoins:code "LICENCE_ISSUED_TOO_YOUNG" ;
  autoins:suggestedAction "Please check the licence issue date and birth date for accuracy." ;
  autoins:legalReference "DVLA licensing regulations" .

############################################################
## BACKEND VALIDATION IMPLEMENTATION NOTES
############################################################

# Implementation Guidelines for Backend Developers
autoins:ValidationImplementationNotes a owl:Class ;
  rdfs:label "Validation Implementation Notes" ;
  rdfs:comment "Guidelines for implementing 5-year date validation in the backend" ;
  autoins:implementationNote """
    BACKEND IMPLEMENTATION REQUIREMENTS:
    
    1. DYNAMIC DATE CALCULATION:
       - Calculate 5 years ago from current date: TODAY - P5Y (ISO 8601 duration)
       - Use server-side date to prevent client-side manipulation
       
    2. VALIDATION LOGIC:
       - Claims: claimDate >= (TODAY - 5 years) AND claimDate <= TODAY
       - Accidents: accidentDate >= (TODAY - 5 years) AND accidentDate <= TODAY  
       - Convictions: convictionDate >= (TODAY - 5 years) AND convictionDate <= TODAY
       
    3. ERROR RESPONSE FORMAT:
       {
         "valid": false,
         "errors": [
           {
             "field": "claimDate",
             "code": "CLAIM_DATE_TOO_OLD", 
             "message": "Claim date must be within the last 5 years",
             "enteredDate": "2018-01-15",
             "fiveYearsAgo": "2020-01-24",
             "severity": "ERROR"
           }
         ]
       }
       
    4. GDPR COMPLIANCE:
       - Log validation attempts for audit purposes
       - Respect user's right to explanation for automated decisions
       - Provide clear guidance on data retention policies
  """ .

############################################################
## FNOL (FIRST NOTICE OF LOSS) COMPLETENESS VALIDATION
############################################################

# FNOL Completeness Shape - Ensures all required elements for claim processing
autoins:FNOLCompletenessShape a sh:NodeShape ;
  sh:targetClass autoins:Claim ;
  rdfs:label "FNOL Completeness Validation" ;
  rdfs:comment "Validates that a claim has all required elements for First Notice of Loss processing" ;
  sh:property [
    sh:path autoins:hasIncident ;
    sh:minCount 1 ;
    sh:class autoins:Accident ;
    sh:message "ðŸš¨ FNOL ERROR: Claim must link to an incident/accident record for complete First Notice of Loss processing." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FNOL_MISSING_INCIDENT" ;
    autoins:i18nKey "validation.fnol.missing_incident"
  ] ;
  sh:property [
    sh:path [ sh:inversePath autoins:relatesToPolicy ] ;
    sh:minCount 1 ;
    sh:class autoins:Policy ;
    sh:message "ðŸ“‹ FNOL ERROR: Claim must relate to a valid insurance policy for processing." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FNOL_MISSING_POLICY" ;
    autoins:i18nKey "validation.fnol.missing_policy"
  ] ;
  sh:property [
    sh:path autoins:claimDate ;
    sh:minCount 1 ;
    sh:datatype xsd:date ;
    sh:message "ðŸ“… FNOL ERROR: Claim date is required for First Notice of Loss." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FNOL_MISSING_CLAIM_DATE" ;
    autoins:i18nKey "validation.fnol.missing_claim_date"
  ] ;
  sh:property [
    sh:path autoins:incidentDate ;
    sh:minCount 1 ;
    sh:datatype xsd:date ;
    sh:message "ðŸ“… FNOL ERROR: Incident date is required for First Notice of Loss." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FNOL_MISSING_INCIDENT_DATE" ;
    autoins:i18nKey "validation.fnol.missing_incident_date"
  ] ;
  sh:property [
    sh:path autoins:claimType ;
    sh:minCount 1 ;
    sh:datatype xsd:string ;
    sh:message "ðŸ·ï¸ FNOL ERROR: Claim type must be specified for processing." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FNOL_MISSING_CLAIM_TYPE" ;
    autoins:i18nKey "validation.fnol.missing_claim_type"
  ] ;
  sh:property [
    sh:path autoins:claimDescription ;
    sh:minCount 1 ;
    sh:datatype xsd:string ;
    sh:minLength 10 ;
    sh:message "ðŸ“ FNOL ERROR: Detailed claim description (minimum 10 characters) is required for processing." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "FNOL_INSUFFICIENT_DESCRIPTION" ;
    autoins:i18nKey "validation.fnol.insufficient_description"
  ] .

# Policy Relationship Propertyo
autoins:relatesToPolicy a owl:ObjectProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range autoins:Policy ;
  rdfs:label "relates to policy" ;
  rdfs:comment "Links a claim to the insurance policy under which it is made" ;
  autoins:i18nKey "claims.relates_to_policy.label" .

# Incident Relationship Property  
autoins:hasIncident a owl:ObjectProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range autoins:Accident ;
  rdfs:label "has incident" ;
  rdfs:comment "Links a claim to the underlying incident/accident" ;
  autoins:i18nKey "claims.has_incident.label" .

############################################################
## RESERVE CALCULATION ONTOLOGY
############################################################

# Reserve Calculation Classes
autoins:ReserveCalculation a owl:Class ;
  rdfs:label "Reserve Calculation" ;
  rdfs:comment "Automated reserve calculation for claims based on severity tables and risk factors" ;
  autoins:i18nKey "claims.reserve_calculation.label" .

autoins:SeverityTable a owl:Class ;
  rdfs:label "Severity Table" ;
  rdfs:comment "Lookup table for base reserve amounts by loss type and vehicle value" ;
  autoins:i18nKey "claims.severity_table.label" .

autoins:FraudIndicator a owl:Class ;
  rdfs:label "Fraud Indicator" ;
  rdfs:comment "Automated fraud detection signals that affect reserve calculations" ;
  autoins:i18nKey "claims.fraud_indicator.label" .

# Reserve Calculation Properties
autoins:baseReserve a owl:DatatypeProperty ;
  rdfs:domain autoins:ReserveCalculation ;
  rdfs:range xsd:decimal ;
  rdfs:label "base reserve" ;
  rdfs:comment "Base reserve amount from severity table lookup" ;
  autoins:i18nKey "claims.base_reserve.label" .

autoins:fraudModifier a owl:DatatypeProperty ;
  rdfs:domain autoins:ReserveCalculation ;
  rdfs:range xsd:decimal ;
  rdfs:label "fraud modifier" ;
  rdfs:comment "Reserve adjustment for fraud signals (+10% of base)" ;
  autoins:i18nKey "claims.fraud_modifier.label" .

autoins:liabilityModifier a owl:DatatypeProperty ;
  rdfs:domain autoins:ReserveCalculation ;
  rdfs:range xsd:decimal ;
  rdfs:label "liability modifier" ;
  rdfs:comment "Reserve adjustment for uncertain liability (+15% of base)" ;
  autoins:i18nKey "claims.liability_modifier.label" .

autoins:partsModifier a owl:DatatypeProperty ;
  rdfs:domain autoins:ReserveCalculation ;
  rdfs:range xsd:decimal ;
  rdfs:label "parts modifier" ;
  rdfs:comment "Reserve adjustment for parts backorder (+5% of base)" ;
  autoins:i18nKey "claims.parts_modifier.label" .

autoins:finalReserve a owl:DatatypeProperty ;
  rdfs:domain autoins:ReserveCalculation ;
  rdfs:range xsd:decimal ;
  rdfs:label "final reserve" ;
  rdfs:comment "Final calculated reserve amount after all modifiers" ;
  autoins:i18nKey "claims.final_reserve.label" .

autoins:reserveBand a owl:DatatypeProperty ;
  rdfs:domain autoins:ReserveCalculation ;
  rdfs:range xsd:string ;
  rdfs:label "reserve band" ;
  rdfs:comment "Quantized reserve band (e.g., Â£0-2k, Â£2-5k, Â£5-10k)" ;
  autoins:enumerationValues ("Â£0-2k" "Â£2k-5k" "Â£5k-10k" "Â£10k-25k" "Â£25k-50k" "Â£50k+") ;
  autoins:i18nKey "claims.reserve_band.label" .

# Fraud Detection Properties
autoins:hasFraudSignals a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "has fraud signals" ;
  rdfs:comment "Indicates presence of automated fraud detection signals" ;
  autoins:i18nKey "claims.has_fraud_signals.label" .

autoins:liabilityUncertain a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "liability uncertain" ;
  rdfs:comment "Indicates uncertain liability determination" ;
  autoins:i18nKey "claims.liability_uncertain.label" .

autoins:partsBackorder a owl:DatatypeProperty ;
  rdfs:domain autoins:Claim ;
  rdfs:range xsd:boolean ;
  rdfs:label "parts backorder" ;
  rdfs:comment "Indicates parts availability issues affecting repair timeline" ;
  autoins:i18nKey "claims.parts_backorder.label" .

autoins:vehicleACV a owl:DatatypeProperty ;
  rdfs:domain autoins:Vehicle ;
  rdfs:range xsd:decimal ;
  rdfs:label "actual cash value" ;
  rdfs:comment "Current actual cash value of vehicle for reserve calculations" ;
  autoins:i18nKey "vehicle.actual_cash_value.label" .

############################################################
## GROUNDED PROMPT PATTERN ONTOLOGY
############################################################

# Grounded AI Response Classes
autoins:GroundedResponse a owl:Class ;
  rdfs:label "Grounded AI Response" ;
  rdfs:comment "AI response that must be grounded in graph data and calculations" ;
  autoins:i18nKey "ai.grounded_response.label" .

autoins:FactReference a owl:Class ;
  rdfs:label "Fact Reference" ;
  rdfs:comment "Reference to specific graph facts used in AI reasoning" ;
  autoins:i18nKey "ai.fact_reference.label" .

autoins:CalculationReference a owl:Class ;
  rdfs:label "Calculation Reference" ;
  rdfs:comment "Reference to specific calculations performed" ;
  autoins:i18nKey "ai.calculation_reference.label" .

# Grounded Response Properties
autoins:usedFacts a owl:ObjectProperty ;
  rdfs:domain autoins:GroundedResponse ;
  rdfs:range autoins:FactReference ;
  rdfs:label "used facts" ;
  rdfs:comment "List of graph facts (IRIs) used in generating the response" ;
  autoins:i18nKey "ai.used_facts.label" .

autoins:performedCalculations a owl:ObjectProperty ;
  rdfs:domain autoins:GroundedResponse ;
  rdfs:range autoins:CalculationReference ;
  rdfs:label "performed calculations" ;
  rdfs:comment "List of calculations performed during response generation" ;
  autoins:i18nKey "ai.performed_calculations.label" .

autoins:factIRI a owl:DatatypeProperty ;
  rdfs:domain autoins:FactReference ;
  rdfs:range xsd:anyURI ;
  rdfs:label "fact IRI" ;
  rdfs:comment "IRI of the graph fact used in reasoning" ;
  autoins:i18nKey "ai.fact_iri.label" .

autoins:factValue a owl:DatatypeProperty ;
  rdfs:domain autoins:FactReference ;
  rdfs:range xsd:string ;
  rdfs:label "fact value" ;
  rdfs:comment "Value of the graph fact used in reasoning" ;
  autoins:i18nKey "ai.fact_value.label" .

autoins:calculationType a owl:DatatypeProperty ;
  rdfs:domain autoins:CalculationReference ;
  rdfs:range xsd:string ;
  rdfs:label "calculation type" ;
  rdfs:comment "Type of calculation performed (COVERAGE_CALC, RESERVE_CALC, FRAUD_SCORER)" ;
  autoins:enumerationValues ("SPARQL_SELECT" "COVERAGE_CALC" "RESERVE_CALC" "FRAUD_SCORER") ;
  autoins:i18nKey "ai.calculation_type.label" .

autoins:calculationResult a owl:DatatypeProperty ;
  rdfs:domain autoins:CalculationReference ;
  rdfs:range xsd:string ;
  rdfs:label "calculation result" ;
  rdfs:comment "Result of the calculation performed" ;
  autoins:i18nKey "ai.calculation_result.label" .

# AI Tool Availability Properties
autoins:availableTools a owl:DatatypeProperty ;
  rdfs:domain autoins:GroundedResponse ;
  rdfs:range xsd:string ;
  rdfs:label "available tools" ;
  rdfs:comment "List of tools available for grounded reasoning" ;
  autoins:enumerationValues ("SPARQL_SELECT" "COVERAGE_CALC" "RESERVE_CALC" "FRAUD_SCORER") ;
  autoins:i18nKey "ai.available_tools.label" .

autoins:requiresFollowUp a owl:DatatypeProperty ;
  rdfs:domain autoins:GroundedResponse ;
  rdfs:range xsd:boolean ;
  rdfs:label "requires follow up" ;
  rdfs:comment "Indicates if response requires targeted follow-up question" ;
  autoins:i18nKey "ai.requires_follow_up.label" .

autoins:followUpQuestion a owl:DatatypeProperty ;
  rdfs:domain autoins:GroundedResponse ;
  rdfs:range xsd:string ;
  rdfs:label "follow up question" ;
  rdfs:comment "Specific targeted follow-up question to gather missing facts" ;
  autoins:i18nKey "ai.follow_up_question.label" .

############################################################
## SYSTEM PROMPT TEMPLATES FOR GROUNDED AI
############################################################

# System Prompt Class
autoins:SystemPrompt a owl:Class ;
  rdfs:label "System Prompt" ;
  rdfs:comment "Structured system prompts for grounded AI responses" ;
  autoins:i18nKey "ai.system_prompt.label" .

# Grounded Claims Processing Prompt
autoins:GroundedClaimsPrompt a autoins:SystemPrompt ;
  rdfs:label "Grounded Claims Processing Prompt" ;
  autoins:promptText """
You are a grounded AI assistant for insurance claims processing. You must answer only from the knowledge graph and attached calculations.

MANDATORY TOOLS AVAILABLE:
- SPARQL_SELECT: Query the insurance ontology graph
- COVERAGE_CALC: Calculate policy coverage amounts
- RESERVE_CALC: Calculate claim reserves using severity tables
- FRAUD_SCORER: Assess fraud risk indicators

GROUNDING REQUIREMENTS:
1. You MUST use SPARQL_SELECT to retrieve facts from the graph before answering
2. You MUST use appropriate calculation tools for any numerical assessments
3. If a fact is missing from the graph, ask ONE targeted follow-up question, then re-check
4. Your final answer MUST list the IRIs of all facts used in your reasoning
5. You MUST cite specific calculation results with their input parameters

RESPONSE FORMAT:
- Answer: [Your grounded response]
- Facts Used: [List of IRIs from graph queries]
- Calculations: [List of calculations performed with results]
- Follow-up Needed: [Yes/No - if missing critical information]

FORBIDDEN ACTIONS:
- Never make assumptions not supported by graph data
- Never provide estimates without using RESERVE_CALC tool
- Never assess coverage without using COVERAGE_CALC tool
- Never ignore fraud indicators without using FRAUD_SCORER tool

User Query: {user_query}
Context: {graph_context}
"""@en ;
  autoins:i18nKey "ai.grounded_claims_prompt.text" ;
  autoins:complianceLevel autoins:GDPR_Strict ;
  autoins:allowedDataCategories autoins:ClaimsData, autoins:PolicyData ;
  autoins:requiredTools "SPARQL_SELECT,COVERAGE_CALC,RESERVE_CALC,FRAUD_SCORER" .

############################################################
## VALIDATION SHAPES FOR GROUNDED RESPONSES
############################################################

# Grounded Response Validation Shape
autoins:GroundedResponseShape a sh:NodeShape ;
  sh:targetClass autoins:GroundedResponse ;
  rdfs:label "Grounded Response Validation" ;
  sh:property [
    sh:path autoins:usedFacts ;
    sh:minCount 1 ;
    sh:message "ðŸ” GROUNDING ERROR: Response must reference at least one graph fact (IRI)." ;
    autoins:validationSeverity "ERROR" ;
    autoins:validationCode "MISSING_FACT_REFERENCES"
  ] ;
  sh:property [
    sh:path autoins:performedCalculations ;
    sh:minCount 0 ;
    sh:message "ðŸ§® CALCULATION INFO: Calculations performed during response generation." ;
    autoins:validationSeverity "INFO" ;
    autoins:validationCode "CALCULATIONS_PERFORMED"
  ] .

############################################################
## END OF CLAIMS HISTORY MODULE
############################################################